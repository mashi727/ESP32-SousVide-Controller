# ESP32 Sous Vide Controller

高精度PID制御を搭載したESP32ベースの低温調理器コントローラー

## 特徴

- **高精度温度制御**: PID制御による±0.1°Cの温度精度
- **直感的な操作**: ロータリーエンコーダーとOLEDディスプレイ
- **WiFi対応**: スマートフォンからの遠隔監視・制御
- **データロギング**: 調理データの記録と分析
- **安全機能**: 過熱保護、センサー異常検知
- **拡張可能**: モジュラー設計により機能追加が容易

## ハードウェア要件

### 必須コンポーネント
- ESP32開発ボード
- DS18B20防水温度センサー（4.7kΩプルアップ抵抗付き）
- SSD1306 OLEDディスプレイ（128x64、I2C接続）
- ロータリーエンコーダー（プッシュボタン付き）
- ソリッドステートリレー（SSR、25A以上推奨）
- AC100V対応防水ケース

### 推奨電源
- 5V 2A以上のUSB電源アダプター

## ピン配置

| コンポーネント | ESP32ピン | 説明 |
|------------|---------|-----|
| DS18B20 | GPIO 4 | 温度センサー（1-Wire） |
| OLED SDA | GPIO 21 | I2Cデータ |
| OLED SCL | GPIO 22 | I2Cクロック |
| エンコーダーA | GPIO 32 | 回転検出A |
| エンコーダーB | GPIO 33 | 回転検出B |
| エンコーダーSW | GPIO 25 | プッシュボタン |
| SSR制御 | GPIO 26 | ヒーター制御 |
| ブザー（オプション） | GPIO 27 | アラーム用 |

## ソフトウェアセットアップ

### PlatformIOを使用（推奨）

1. Visual Studio CodeにPlatformIOをインストール
2. プロジェクトをクローン
```bash
git clone https://github.com/yourusername/SC_ESP32.git
cd SC_ESP32
```
3. PlatformIOでプロジェクトを開く
4. ビルドとアップロード
```bash
pio run -t upload
```

### Arduino IDEを使用

1. ESP32ボードサポートをインストール
2. 必要なライブラリをインストール：
   - OneWire
   - DallasTemperature
   - Adafruit SSD1306
   - Adafruit GFX
   - ArduinoJson
3. SC_ESP32.inoを開く
4. ボードとポートを選択してアップロード

## 使用方法

### 基本操作

1. **電源投入**: ESP32に電源を接続
2. **温度設定**: 
   - ボタンを押して設定モードに入る
   - エンコーダーを回して温度を調整（20-95°C）
   - ボタンを押して確定
3. **時間設定**:
   - エンコーダーを回して調理時間を設定
   - ボタンを押して調理開始
4. **調理中**:
   - 現在温度と残り時間が表示される
   - ボタンで一時停止/再開
   - 長押しで中止

### WiFi設定

1. `Config.h`でWiFi認証情報を設定
```cpp
#define WIFI_SSID "YourWiFiSSID"
#define WIFI_PASSWORD "YourWiFiPassword"
```
2. 再コンパイル・アップロード
3. シリアルモニタでIPアドレスを確認
4. ブラウザでアクセス: `http://[IPアドレス]`

## 安全上の注意

⚠️ **警告**: AC100Vを扱うため、以下の注意事項を必ず守ってください

- 防水ケースに収納して使用する
- 濡れた手で操作しない
- SSRの配線は確実に絶縁する
- 定格以上の負荷を接続しない
- 異常時は直ちに電源を切る

## カスタマイズ

### PIDパラメータの調整

`Config.h`で調整可能：
```cpp
#define DEFAULT_KP 2.0  // 比例ゲイン
#define DEFAULT_KI 0.5  // 積分ゲイン
#define DEFAULT_KD 1.0  // 微分ゲイン
```

### 温度較正

センサーのオフセット調整：
```cpp
tempSensor.setCalibrationOffset(0.5); // +0.5°C補正
```

## トラブルシューティング

| 問題 | 原因 | 解決方法 |
|-----|-----|---------|
| 温度が表示されない | センサー未接続 | 配線を確認、プルアップ抵抗を確認 |
| 温度が不安定 | ノイズ | センサーケーブルをシールド、電源を分離 |
| WiFi接続失敗 | 認証情報誤り | SSID/パスワードを確認 |
| ヒーターが動作しない | SSR故障 | SSRの入力電圧（3.3V）を確認 |

## ライセンス

MIT License

## 貢献

プルリクエストを歓迎します。大きな変更の場合は、まずissueを開いて変更内容を議論してください。

## サポート

問題が発生した場合は、[Issues](https://github.com/yourusername/SC_ESP32/issues)で報告してください。